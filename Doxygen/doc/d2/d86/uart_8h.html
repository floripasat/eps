<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FloripaSat-EPS: uart.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../floripasat-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FloripaSat-EPS
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Electrical Power System of the FloripaSat project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/d86/uart_8h.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">uart.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>UART driver header.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="../../d2/d86/uart_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5538549d2f780f6edf05e96aa8d20a28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d86/uart_8h.html#a5538549d2f780f6edf05e96aa8d20a28">port_mapping</a> (void)</td></tr>
<tr class="memdesc:a5538549d2f780f6edf05e96aa8d20a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps multi-function port 2 pins to UART.  <a href="#a5538549d2f780f6edf05e96aa8d20a28">More...</a><br /></td></tr>
<tr class="separator:a5538549d2f780f6edf05e96aa8d20a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb2565a333438fc66b5725bf1e41ca0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d86/uart_8h.html#afb2565a333438fc66b5725bf1e41ca0f">uart_config</a> (void)</td></tr>
<tr class="memdesc:afb2565a333438fc66b5725bf1e41ca0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the UART peripheral.  <a href="#afb2565a333438fc66b5725bf1e41ca0f">More...</a><br /></td></tr>
<tr class="separator:afb2565a333438fc66b5725bf1e41ca0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89b18c4ff25f288ffeb07bd0d0a1b768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d86/uart_8h.html#a89b18c4ff25f288ffeb07bd0d0a1b768">uart_tx_debug</a> (uint8_t *tx_data)</td></tr>
<tr class="memdesc:a89b18c4ff25f288ffeb07bd0d0a1b768"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends data to the debug port.  <a href="#a89b18c4ff25f288ffeb07bd0d0a1b768">More...</a><br /></td></tr>
<tr class="separator:a89b18c4ff25f288ffeb07bd0d0a1b768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac60bfafee36fce4de5445c22542d7a36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d86/uart_8h.html#ac60bfafee36fce4de5445c22542d7a36">uart_tx_beacon</a> (uint8_t tx_data)</td></tr>
<tr class="memdesc:ac60bfafee36fce4de5445c22542d7a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends data to Beacon.  <a href="#ac60bfafee36fce4de5445c22542d7a36">More...</a><br /></td></tr>
<tr class="separator:ac60bfafee36fce4de5445c22542d7a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d6f18b4a31616a70766ed0f8721950"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d86/uart_8h.html#a41d6f18b4a31616a70766ed0f8721950">float_send</a> (float c)</td></tr>
<tr class="memdesc:a41d6f18b4a31616a70766ed0f8721950"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends floating point data to the debug port.  <a href="#a41d6f18b4a31616a70766ed0f8721950">More...</a><br /></td></tr>
<tr class="separator:a41d6f18b4a31616a70766ed0f8721950"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">UART driver header. </p>
<dl class="section author"><dt>Author</dt><dd>Bruno Vale Barbosa Eiterer </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d2/d86/uart_8h_source.html">uart.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5538549d2f780f6edf05e96aa8d20a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5538549d2f780f6edf05e96aa8d20a28">&#9670;&nbsp;</a></span>port_mapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_mapping </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps multi-function port 2 pins to UART. </p>
<p class="">First it enables write-access to the port mapping registers in the PMAPPWD register, then it chooses the UCA0TXD function in the P2MAP4 register, then it disables write-access to port mapping registers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">-</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/uart_8c_source.html#l00120">120</a> of file <a class="el" href="../../d1/d87/uart_8c_source.html">uart.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d87/uart_8c_source.html#l00040">uart_config()</a>.</p>

</div>
</div>
<a id="afb2565a333438fc66b5725bf1e41ca0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb2565a333438fc66b5725bf1e41ca0f">&#9670;&nbsp;</a></span>uart_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart_config </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the UART peripheral. </p>
<p class="">The first step is to call port_mapping.</p>
<p class="">The first interface configuration done is the UCA2, used for debugging. First it assigns P9.2 to UCA2TXD and P9.3 to UCA2RXD. Then it sets the UCSWRST bit in the UCA2CTL1 register, allowing the configuration to start. Then it selects the ACLK (16 MHz) clock source in the UCA2CTL1 register. The baud rate is selected in the UCA2BR0 and UCA2BR1 registers, with values of 0x8A and 0x00, respectively. This results in 16000000/138 = ~115942 bps. Then the modulation is set in the UCA2MCTL, with UCBRS_7 + UCBRF_0, resulting in a baud rate close of 115200 bps. To finish the configuration the UCSWRST bit is cleared in the UCA2CTL1 register, resuming normal operation.</p>
<p class="">The second interface configuration done is the UCA0, used to communicate with Beacon. First it assigns P2.4 to UCA0TXD, then it sets the UCSWRST bit in the UCA0CTL1 register. The clock source used is also ACLK (16 MHz). The baud rate registers UCA0BR0 and UCA0BR1 are set wth 0xD0 and 0x00, respectively. In the UCA0MCTL register the modulation select is UCBRS_0 and UCBRF_5 with oversampling defined by UCOS16, resulting in a baud rate of ~4800 bps. Then it clears the UCSWRST bit as well, returning to normal operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">-</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/uart_8c_source.html#l00040">40</a> of file <a class="el" href="../../d1/d87/uart_8c_source.html">uart.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d87/uart_8c_source.html#l00120">port_mapping()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/main_8c_source.html#l00069">config_msp430()</a>.</p>

</div>
</div>
<a id="a89b18c4ff25f288ffeb07bd0d0a1b768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89b18c4ff25f288ffeb07bd0d0a1b768">&#9670;&nbsp;</a></span>uart_tx_debug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart_tx_debug </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>tx_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends data to the debug port. </p>
<p class="">This function sends a byte of data to the debug port. Before each bit is transmitted, it checks if the line is busy through the UCBUSY bit in the UCA2STAT register. Then it sends the bit by putting it in the UCA2TXBUF register. It loops until the end of the data is reached.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx_data</td><td>is a pointer to the data to be sent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/uart_8c_source.html#l00076">76</a> of file <a class="el" href="../../d1/d87/uart_8c_source.html">uart.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/da8/ADS1248_8c_source.html#l00019">config_ADS1248()</a>, <a class="el" href="../../df/d13/onewire_8c_source.html#l00195">config_DS2775()</a>, <a class="el" href="../../d0/d29/main_8c_source.html#l00069">config_msp430()</a>, <a class="el" href="../../d1/d87/uart_8c_source.html#l00143">float_send()</a>, <a class="el" href="../../d0/d29/main_8c_source.html#l00033">main()</a>, <a class="el" href="../../d5/d6a/mppt_8c_source.html#l00006">mppt_algorithm()</a>, <a class="el" href="../../df/d41/timer_8c_source.html#l00025">timer0_a0_isr()</a>, and <a class="el" href="../../df/d41/timer_8c_source.html#l00333">timer0_a1_isr()</a>.</p>

</div>
</div>
<a id="ac60bfafee36fce4de5445c22542d7a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac60bfafee36fce4de5445c22542d7a36">&#9670;&nbsp;</a></span>uart_tx_beacon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart_tx_beacon </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>tx_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends data to Beacon. </p>
<p class="">Sends data to Beacon.</p>
<p class="">Sends a byte of data to Beacon. First it checks if the line is busy, using the UCBUSY bit in the UCA0STAT register. Then it places the data to be sent in the UCA0TXBUF register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx_data</td><td>is an unsigned integer of 8 bits, containing the data to be sent to Beacon</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/uart_8c_source.html#l00101">101</a> of file <a class="el" href="../../d1/d87/uart_8c_source.html">uart.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d41/timer_8c_source.html#l00025">timer0_a0_isr()</a>.</p>

</div>
</div>
<a id="a41d6f18b4a31616a70766ed0f8721950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41d6f18b4a31616a70766ed0f8721950">&#9670;&nbsp;</a></span>float_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void float_send </td>
          <td>(</td>
          <td class="paramtype">volatile float&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends floating point data to the debug port. </p>
<p class="">First it verifies if the floating point number passed is negative, if it is it sends a "-" character, then inverts the number. Then it converts the number to a string, and passes the string to uart_tx_debug.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>is the floating point number to be sent via UART.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d87/uart_8c_source.html#l00143">143</a> of file <a class="el" href="../../d1/d87/uart_8c_source.html">uart.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d87/uart_8c_source.html#l00076">uart_tx_debug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d6a/mppt_8c_source.html#l00006">mppt_algorithm()</a>, <a class="el" href="../../df/d41/timer_8c_source.html#l00025">timer0_a0_isr()</a>, and <a class="el" href="../../df/d41/timer_8c_source.html#l00333">timer0_a1_isr()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d2/d86/uart_8h.html">uart.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
